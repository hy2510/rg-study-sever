import{r as i,j as e,R as S}from"./react-918e84ef.js";import{c as I}from"./react-dom-af419565.js";import{a as j}from"./axios-7a713374.js";import{p as l}from"./phaser-1f8d029d.js";import"./scheduler-765c72db.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const u=i.createContext(void 0);function C({children:r}){const o=f("REF"),t=R(o),a=f("apiStudyInfo"),n=v(a);if(t.StudyId!==n.stdid||t.StudentHistoryId!==n.sthid)throw Error("Study Info Invalid");const[s,c]=i.useState(!1),d={User:t.User,StudyId:t.StudyId,StudentHistoryId:t.StudentHistoryId},g={Mode:t.Mode,BookType:t.BookType,Round:n.book,Level:t.level,LevelName:t.LevelName,LevelRoundId:t.LevelRoundId},m={isShowMovie:s,changeShowMovie:x=>{c(x)}},y={userInfo:{...d},bookInfo:{...g},handler:{...m}};return e.jsx(u.Provider,{value:y,children:r})}const f=r=>window.sessionStorage.getItem(r),R=r=>JSON.parse(decodeURIComponent(atob(r))),v=r=>JSON.parse(r),b="/api/study/pre-k",w=async(r,o)=>{let t={ClassId:"",ClassName:"",DayRgPoint:0,Round:0,StatusCode:"",StudentId:"",StudentName:"",StudyYn:!1,Synopsis:""};try{t=(await j.get(`${b}/info?studyId=${r}&studentHistoryId=${o}`)).data}catch{}return t};function E({startStep:r}){return e.jsx(e.Fragment,{children:"AlphabetContainer"})}function F({startStep:r}){return e.jsx(e.Fragment,{children:"PhonicsContainer01"})}function P({startStep:r}){return e.jsx(e.Fragment,{children:"PhonicsContainer01"})}function M({startStep:r}){return e.jsx(e.Fragment,{children:"SightWordContainer01"})}function L({changeStep:r}){return e.jsx(e.Fragment,{children:"ListenAndRepeat"})}function k(){const{handler:r}=i.useContext(u);return e.jsxs(e.Fragment,{children:["sight words 2 movie",e.jsx("div",{onClick:()=>{r.changeShowMovie(!0)},children:"click"})]})}const h=new l.Events.EventEmitter,N="/study/NewDodoABC/assets/react-35ef61ed.svg";class H extends Phaser.Scene{constructor(){super("Loading")}init(o){console.log(o),console.log(this.game.registry.get("studyId"))}preload(){this.load.image("logo",N)}create(){this.scene.start("Preloader",{message:"hello"})}}class A extends Phaser.Scene{constructor(){super("Preloader")}init(o){console.log(o)}preload(){}create(){}}function B({studyId:r,studentHistoryId:o}){const t={title:"spelling",type:l.AUTO,width:1024,height:768,parent:"phaser",backgroundColor:"#fff",scene:[H,A]},a=new l.Game(t);return a.registry.set("studyId",r),a.registry.set("studentHistoryId",o),a}const p=i.forwardRef(function({currentActiveScene:o},t){const{userInfo:a}=i.useContext(u),n=i.useRef(null);return i.useLayoutEffect(()=>(n.current===null&&(n.current=B({studyId:a.StudyId,studentHistoryId:a.StudentHistoryId}),typeof t=="function"?t({game:n.current,scene:null}):t&&(t.current={game:n.current,scene:null})),()=>{n.current&&(n.current.destroy(!0),n.current!==null&&(n.current=null))}),[t]),i.useEffect(()=>(h.on("current-scene-ready",s=>{o&&typeof o=="function"&&o(s),typeof t=="function"?t({game:n.current,scene:s}):t&&(t.current={game:n.current,scene:s})}),()=>{h.removeListener("current-scene-ready")}),[o,t]),e.jsx("div",{id:"phaser"})});function O(){const r=i.useRef(null);return e.jsx(p,{ref:r})}function D(){const r=i.useRef(null);return e.jsx(p,{ref:r})}function G(){return e.jsx(e.Fragment,{children:"Jump Leoni"})}function J(){return e.jsx(e.Fragment,{children:"Pearl Hunting"})}function U(){return e.jsx(e.Fragment,{children:"DJBlanc"})}function $(){return e.jsx(e.Fragment,{children:"Gino Plate"})}function T(){return e.jsx(e.Fragment,{children:"Milo Factory"})}function W(){return e.jsx(e.Fragment,{children:"Relay Race"})}function V({startStep:r}){const{handler:o}=i.useContext(u),[t,a]=i.useState(r),[n,s]=i.useState(),c=d=>{a(d)};return i.useEffect(()=>{switch(console.log(t),t){case 1:o.isShowMovie?s(e.jsx(L,{changeStep:c})):s(e.jsx(k,{}));break;case 2:Math.floor(Math.random()*100)%2==0?s(e.jsx(O,{})):s(e.jsx(D,{}));break;case 3:Math.floor(Math.random()*100)%2==0?s(e.jsx(G,{})):s(e.jsx(J,{}));break;case 4:Math.floor(Math.random()*100)%2==0?s(e.jsx(U,{})):s(e.jsx($,{}));break;case 5:Math.floor(Math.random()*100)%2==0?s(e.jsx(T,{})):s(e.jsx(W,{}));break}},[t,o.isShowMovie]),i.useEffect(()=>{},[n]),e.jsx(e.Fragment,{children:n})}function q(){const{userInfo:r,bookInfo:o}=i.useContext(u),t=Number(o.Round),[a,n]=i.useState(0);return i.useEffect(()=>{(async()=>{const c=await w(r.StudyId,r.StudentHistoryId);if(c)switch(c.StatusCode){case"025001":n(1);break;case"025002":n(2);break;case"025003":n(3);break;case"025004":n(4);break;case"025005":n(5);break}else throw new Error("Error: Failed Get Study Info")})()},[]),i.useEffect(()=>{},[a]),t>=301&&t<=326?e.jsx(E,{startStep:a}):t>=401&&t<=427?e.jsx(F,{startStep:a}):t>=428&&t<=450?e.jsx(P,{startStep:a}):t>=501&&t<=530?e.jsx(M,{startStep:a}):t>=531&&t<=560?e.jsx(V,{startStep:a}):e.jsx(e.Fragment,{children:"Error!! please call 1599-0533"})}function K(){return e.jsx(e.Fragment,{children:"game container"})}function Y(){return e.jsx(e.Fragment,{children:"song and chant container"})}function z(){const{bookInfo:r}=i.useContext(u),o=Number(r.Round);return o>=301&&o<=560?e.jsx(q,{}):o>=601&&o<=700?e.jsx(K,{}):o>=701&&o<=850?e.jsx(Y,{}):e.jsx(e.Fragment,{children:"Error please call 1599-0533"})}function Q(){return e.jsx(C,{children:e.jsx(z,{})})}I.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(Q,{})}));
